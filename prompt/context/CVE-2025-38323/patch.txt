    diff --git a/net/atm/lec.c b/net/atm/lec.c
    index acef984f336709..1e1f3eb0e2ba3c 100644
    --- a/net/atm/lec.c
    +++ b/net/atm/lec.c
    @@ -124,6 +124,7 @@ static unsigned char bus_mac[ETH_ALEN] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };
     
     /* Device structures */
     static struct net_device *dev_lec[MAX_LEC_ITF];
    +static DEFINE_MUTEX(lec_mutex);
     
     #if IS_ENABLED(CONFIG_BRIDGE)
     static void lec_handle_bridge(struct sk_buff *skb, struct net_device *dev)
    @@ -742,6 +746,7 @@ static int lecd_attach(struct atm_vcc *vcc, int arg)
     		snprintf(dev_lec[i]->name, IFNAMSIZ, "lec%d", i);
     		if (register_netdev(dev_lec[i])) {
     			free_netdev(dev_lec[i]);
    +			dev_lec[i] = NULL;
     			return -EINVAL;
     		}
     
    @@ -1003,6 +1008,7 @@ static int lane_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg)
     		return -ENOIOCTLCMD;
     	}
     
    +	mutex_lock(&lec_mutex);
     	switch (cmd) {
     	case ATMLEC_CTRL:
     		err = lecd_attach(vcc, (int)arg);
    @@ -1017,6 +1023,7 @@ static int lane_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg)
     		break;
     	}
     
    +	mutex_unlock(&lec_mutex);
     	return err;
     }