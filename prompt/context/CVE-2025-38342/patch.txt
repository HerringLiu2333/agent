    @@ -529,7 +529,7 @@ software_node_get_reference_args(const struct fwnode_handle *fwnode,
     	if (prop->is_inline)
     		return -EINVAL;
     
    -	if (index * sizeof(*ref) >= prop->length)
    +	if ((index + 1) * sizeof(*ref) > prop->length)
     		return -ENOENT;
     
     	ref_array = prop->pointer;