    @@ -1822,12 +1822,16 @@ static int at91_gpio_probe(struct platform_device *pdev)
     	struct gpio_chip *chip;
     	struct pinctrl_gpio_range *range;
    +	int alias_idx;
     	int ret = 0;
     	int irq, i;
    -	int alias_idx = of_alias_get_id(np, "gpio");
     	uint32_t ngpio;
     	char **names;
     
    +	alias_idx = of_alias_get_id(np, "gpio");
    +	if (alias_idx < 0)
    +		return alias_idx;
    +
     	BUG_ON(alias_idx >= ARRAY_SIZE(gpio_chips));
     	if (gpio_chips[alias_idx])
     		return dev_err_probe(dev, -EBUSY, "%d slot is occupied.\n", alias_idx);