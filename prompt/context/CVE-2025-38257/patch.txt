    @@ -86,7 +86,7 @@ static void *_copy_apqns_from_user(void __user *uapqns, size_t nr_apqns)
     	if (!uapqns || nr_apqns == 0)
     		return NULL;
     
    -	return memdup_user(uapqns, nr_apqns * sizeof(struct pkey_apqn));
    +	return memdup_array_user(uapqns, nr_apqns, sizeof(struct pkey_apqn));
     }
     
     static int pkey_ioctl_genseck(struct pkey_genseck __user *ugs)