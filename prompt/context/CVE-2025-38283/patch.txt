    @@ -498,6 +491,20 @@ static int vf_qm_load_data(struct hisi_acc_vf_core_device *hisi_acc_vdev,
     	if (migf->total_length < sizeof(struct acc_vf_data))
     		return -EINVAL;
     
    +	if (!vf_data->eqe_dma || !vf_data->aeqe_dma ||
    +	    !vf_data->sqc_dma || !vf_data->cqc_dma) {
    +		dev_info(dev, "resume dma addr is NULL!\n");
    +		hisi_acc_vdev->vf_qm_state = QM_NOT_READY;
    +		return 0;
    +	}
    +
     	qm->eqe_dma = vf_data->eqe_dma;
     	qm->aeqe_dma = vf_data->aeqe_dma;
     	qm->sqc_dma = vf_data->sqc_dma;
    ...
    @@ -1531,6 +1538,7 @@ static int hisi_acc_vfio_pci_migrn_init_dev(struct vfio_device *core_vdev)
     	hisi_acc_vdev->vf_id = pci_iov_vf_id(pdev) + 1;
     	hisi_acc_vdev->pf_qm = pf_qm;
     	hisi_acc_vdev->vf_dev = pdev;
    +	hisi_acc_vdev->vf_qm_state = QM_NOT_READY;
     	mutex_init(&hisi_acc_vdev->state_mutex);
     	mutex_init(&hisi_acc_vdev->open_mutex);