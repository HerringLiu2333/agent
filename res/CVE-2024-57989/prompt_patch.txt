1. CVE Identifier
CVE-2024-57989

2. Vulnerability Type
NULL pointer dereference due to missing allocation failure check

3. Root Cause Summary
mt7925_change_vif_links() allocates per-link structures (mconf, mlink) using devm_kzalloc() but did not check for NULL returns before using these pointers. When devm_kzalloc() fails under memory pressure, the function proceeds, leading to subsequent dereference of NULL pointers. This oversight in pre-patch logic causes a kernel crash (DoS) during VIF link changes.

4. Kernel Subsystem Analysis
1) Affected Subsystem:
MediaTek mt76 mt7925 Wi-Fi driver (drivers/net/wireless/mediatek/mt76/mt7925/main.c)

2) Pre-Patch Flaw:
Within mt7925_change_vif_links(), two devm_kzalloc() calls allocate mconf and mlink, but the code did not validate the returned pointers. The function continues to operate (e.g., “mconfs[link_id] = mconf;”) and later uses these structures without ensuring they are non-NULL, making a NULL dereference possible.

3) Trigger Condition:
Memory allocation failure in devm_kzalloc() for either mconf or mlink during a change of VIF links (e.g., under low-memory conditions).

4) Impact Mechanism:
Subsequent access to fields of mconf or mlink (or via mconfs[]/mlinks[] entries) results in a NULL pointer dereference, causing a kernel oops/panic and denial of service.

5. Patch Analysis
1) Fix Approach:
Introduce an early error-return on allocation failures, ensuring the function exits with -ENOMEM before any use of potentially NULL pointers.

2) Key Code Changes:
Added:
“if (!mconf || !mlink)
    return -ENOMEM;”
immediately after both devm_kzalloc() calls in mt7925_change_vif_links().

3) Locking/Concurrency Impact:
None. The patch only adds allocation failure checks and an early return; it does not modify locking or concurrency behavior. Any concurrency implications are Unknown/Not determinable from the provided diff.

6. Broader Kernel Security Implications
Validating memory allocation results is critical in kernel drivers to prevent crashes under memory pressure. This fix hardens the mt7925 driver against unprivileged denial-of-service scenarios that could be triggered by operations involving VIF link changes when memory is constrained. Ensuring consistent error handling and propagation reduces the kernel’s susceptibility to reliability and availability issues across the wireless subsystem.