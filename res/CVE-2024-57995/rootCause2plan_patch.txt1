1. Plan Summary
Detect read-after-free in ath12k where a VIF pointer is dereferenced after being invalidated by ath12k_mac_unassign_link_vif() and before being revalidated by ath12k_mac_assign_link_vif().

2. Detection Steps
1) Step 1: Scope identification — Focus on C functions in drivers/net/wireless/ath/ath12k/mac.c that manipulate a VIF pointer used with ath12k_mac_unassign_link_vif() and ath12k_mac_assign_link_vif().

2) Step 2: Free-invalidation modeling — For each call to ath12k_mac_unassign_link_vif(), identify the VIF pointer argument and mark that variable (and its straightforward aliases) as invalidated/freed immediately after the call.

3) Step 3: Revalidation modeling — Identify the next point in the same function where the same VIF pointer is reassigned/validated:
- A call to ath12k_mac_assign_link_vif() that assigns/re-associates the pointer.
- Any direct assignment writing a new value to the same pointer variable.

4) Step 4: Region of interest — Compute the control-flow region from the invalidation point up to (but not including) the first revalidation point (or function exit if none).

5) Step 5: Dereference use detection — Within that region, find dereferences of the invalidated pointer, including:
- Field/member access (ptr->field) such as ptr->is_created.
- Unary dereference (*ptr) or array-like usage deriving from ptr.

6) Step 6: Path feasibility — Ensure there exists at least one control-flow path from the invalidation to the dereference that does not pass through any revalidation; incorporate gotos/labels (e.g., flush/unlock paths) and early exits.

7) Step 7: Exclusions for reinit — Exclude dereferences that are dominated by a revalidation event (ath12k_mac_assign_link_vif() on the same variable) or by a definite assignment to the pointer variable that would make it valid again.

8) Step 8: Prioritization of conditional reads — Prioritize findings where the dereference occurs in conditionals (e.g., if (ptr->is_created)) immediately following unassign paths, as these reflect the CVE pattern.

9) Step 9: Reporting — For each match, report the invalidating call site and the subsequent dereference site, noting that the dereference occurs before any call to ath12k_mac_assign_link_vif() or other reinitialization.

3. Limitations & Assumptions
- Assumes ath12k_mac_unassign_link_vif() frees/invalidates the VIF pointer and ath12k_mac_assign_link_vif() reassigns/validates it, per the provided analysis; the checker does not inspect their implementations.
- Limits dereference detection to direct syntactic uses (ptr->field, *ptr); it does not model interprocedural dereferences inside other callees.
- Aliasing is handled only for simple same-variable uses; complex aliasing (copies, fields, containers) may cause false negatives or positives.
- Revalidation via means other than ath12k_mac_assign_link_vif() or direct assignment may be missed due to lack of broader project context.
- The plan targets the ath12k driver context; extending to other subsystems would require additional free/reassign function models not provided here.