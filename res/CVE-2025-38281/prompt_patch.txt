1. CVE Identifier
CVE-2025-38281

2. Vulnerability Type
NULL pointer dereference due to missing allocation-failure check

3. Root Cause Summary
mt7996_thermal_init() failed to validate the return value of devm_kasprintf() before using it as the device name for thermal_cooling_device_register(). When devm_kasprintf() returned NULL on allocation failure, the subsequent use of this NULL pointer led to a kernel NULL pointer dereference during thermal cooling device registration.

4. Kernel Subsystem Analysis
1) Affected Subsystem:
MediaTek mt76 Wi-Fi driver (mt7996) thermal management initialization

2) Pre-Patch Flaw:
The function assigned:
- name = devm_kasprintf(&wiphy->dev, GFP_KERNEL, "mt7996_%s.%d", wiphy_name(wiphy), phy->mt76->band_idx);
and did not check if name was NULL before proceeding to register the thermal cooling device, thereby passing a NULL name to thermal_cooling_device_register().

3) Trigger Condition:
devm_kasprintf() fails and returns NULL (e.g., under memory pressure) during mt7996_thermal_init() execution.

4) Impact Mechanism:
Passing a NULL pointer as the device name into thermal_cooling_device_register() triggers a kernel NULL pointer dereference inside the thermal registration path, causing a kernel crash (DoS).

5. Patch Analysis
1) Fix Approach:
Defensive programming: add a NULL check after devm_kasprintf() and abort initialization with -ENOMEM if allocation failed, preventing use of a NULL pointer.

2) Key Code Changes:
- Inserted:
  if (!name)
      return -ENOMEM;
immediately after the devm_kasprintf() call in mt7996_thermal_init().

3) Locking/Concurrency Impact:
None. The change only adds an early error return on allocation failure; no locks or ordering were modified.

6. Broader Kernel Security Implications
Unchecked allocation failures in driver init paths can convert recoverable OOM conditions into kernel crashes. This fix improves robustness against memory pressure and exemplifies a common hardening pattern needed across drivers: validate all devm_* and k*alloc* returns before use. System stability and reliability are enhanced, reducing potential for unprivileged DoS via triggerable device initialization under low-memory conditions.