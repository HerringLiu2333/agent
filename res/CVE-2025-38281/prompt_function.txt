1. CVE Identifier
CVE-2025-38281

2. Vulnerability Type
NULL pointer dereference leading to kernel crash (Denial of Service)

3. Root Cause Summary
The function mt7996_thermal_init() fails to validate the return value of devm_kasprintf() when constructing the device name. On allocation failure, devm_kasprintf() returns NULL, but the code immediately uses this NULL pointer as the name argument for thermal_cooling_device_register() and devm_hwmon_device_register_with_groups(), resulting in a kernel NULL pointer dereference. The patch adds a NULL check and returns -ENOMEM early, preventing subsequent unsafe use.

4. Kernel Subsystem Analysis
1) Affected Subsystem:
wifi: mt76 mt7996 driver thermal/hwmon initialization

2) Pre-Patch Flaw:
In mt7996_thermal_init(), the code assigns “name = devm_kasprintf(...);” and then uses name without checking for NULL in thermal_cooling_device_register(name, ...) and devm_hwmon_device_register_with_groups(&wiphy->dev, name, ...).

3) Trigger Condition:
devm_kasprintf(&wiphy->dev, GFP_KERNEL, ...) fails under memory pressure and returns NULL during mt7996 PHY thermal initialization.

4) Impact Mechanism:
A NULL name pointer is passed into kernel registration functions that expect a valid string, leading to a NULL pointer dereference in those functions or subsequent sysfs/kobject operations, causing a kernel oops and denial of service.

5. Patch Analysis
1) Fix Approach:
Defensive programming: add a NULL check immediately after devm_kasprintf() and abort initialization with -ENOMEM if the allocation fails.

2) Key Code Changes:
Inserted:
“if (!name)
    return -ENOMEM;”
right after:
“name = devm_kasprintf(&wiphy->dev, GFP_KERNEL, "mt7996_%s.%d", wiphy_name(wiphy), phy->mt76->band_idx);”

3) Locking/Concurrency Impact:
No locking or concurrency changes; the patch only adds input validation and early return, leaving synchronization behavior unchanged.

6. Broader Kernel Security Implications
Properly handling allocation failures in driver init paths prevents kernel crashes induced by memory pressure, reducing attack surface for denial-of-service via resource exhaustion. This change reinforces a general pattern to validate devm_* allocations and formatted strings before use, especially for names passed into kobject/sysfs and registration APIs. Auditing similar paths across the mt76 subsystem and other drivers can further harden the kernel against NULL dereference bugs.